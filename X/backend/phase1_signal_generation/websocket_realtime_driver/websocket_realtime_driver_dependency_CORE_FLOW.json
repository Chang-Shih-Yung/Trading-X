{
  "websocket_realtime_driver_visual_flow": {
    "版本": "1.0.0",
    "標題": "WebSocket實時驅動器核心流程視覺化",
    "描述": "Phase1信號生成系統的多交易所實時數據管道與主時間源",
    "增強特色": "🌐 多交易所 + ⚡ 低延遲 + 🕐 主時間源 + 🔄 自動恢復 + 📊 數據分發",
    
    "🎨 視覺化流程圖": {
      "流程總覽": "🌐 多交易所連接 → 📡 數據接收 → 🔄 統一處理 → 📊 信號分發 → ⚡ Phase1系統",
      
      "🏗️ 層級架構": {
        "🌐 Layer 0": {
          "名稱": "多交易所連接管理層",
          "表情符號": "🌐🔗",
          "狀態": "✅ 多源連接",
          "處理時間": "2ms",
          "描述": "同時管理多個加密貨幣交易所的WebSocket連接",
          "核心功能": [
            "🏢 Binance主要數據源 (權重70%)",
            "🏢 OKX輔助數據源 (權重20%)", 
            "🏢 Bybit備份數據源 (權重10%)",
            "🔄 自動故障切換 (<500ms)",
            "💓 連接健康監控 (heartbeat每30s)",
            "🔧 自動重連機制 (指數退避)"
          ],
          "操作步驟": {
            "連接建立": "並行建立3個交易所WebSocket",
            "健康檢查": "持續監控連接狀態與延遲",
            "故障檢測": "超過3s無數據自動切換",
            "數據同步": "時間戳對齊與數據驗證"
          },
          "輸出": "multi_exchange_raw_data_streams",
          "視覺流程": "🏢 Binance → 🔗 連接池 ← 🏢 OKX ← 🏢 Bybit → 💓 健康監控"
        },
        
        "📡 Layer 1": {
          "名稱": "實時數據接收與預處理層",
          "表情符號": "📡🔄",
          "狀態": "✅ 高速處理",
          "處理時間": "5ms",
          "描述": "高效接收、驗證、初步處理來自多交易所的實時數據",
          "數據處理管道": {
            "🎯 目標Symbol": "BTC/USDT, ETH/USDT, SOL/USDT主要交易對",
            "📊 數據類型": "實時價格、成交量、深度、K線數據",
            "⚡ 處理頻率": "每100ms更新週期",
            "🔧 數據驗證": "格式檢查、異常值過濾、時序驗證"
          },
          "操作步驟": {
            "🎯 數據接收": {
              "WebSocket監聽": "非阻塞事件驅動接收",
              "數據緩衝": "100ms滑動窗口緩衝",
              "並行處理": "多symbol並行數據流",
              "時間": "2ms"
            },
            "🔧 初步驗證": {
              "格式檢查": "JSON結構與必要欄位驗證",
              "異常過濾": "price>±10%突變檢測",
              "時序驗證": "時間戳順序與合理性",
              "時間": "2ms"
            },
            "📊 數據標準化": {
              "時間戳統一": "ISO_8601_UTC格式",
              "價格精度": "8位小數標準化",
              "成交量單位": "基礎貨幣單位統一",
              "時間": "1ms"
            }
          },
          "輸出": "validated_real_time_market_data",
          "視覺流程": "📡 WebSocket → 🎯 接收 → 🔧 驗證 → 📊 標準化 → ✅ 驗證數據"
        },
        
        "🚀 Layer 2": {
          "名稱": "Phase1系統信號分發層",
          "表情符號": "🚀📤",
          "狀態": "✅ 智能分發",
          "處理時間": "5ms",
          "描述": "作為Phase1系統主時間源的智能數據分發中樞",
          "分發架構": {
            "🕐 主時間源": "為整個Phase1系統提供統一時間基準",
            "📊 智能路由": "根據模組需求分發不同數據類型",
            "⚡ 緊急通道": "極端市場條件快速分發",
            "🔄 負載均衡": "平衡各模組處理負載"
          },
          "操作步驟": {
            "🕐 時間同步廣播": {
              "主時間源": "100ms統一時間戳廣播",
              "同步容忍度": "±100ms內視為同步",
              "分發目標": "Phase1A、1B、1C、Indicators全模組",
              "時間": "1ms"
            },
            "📊 智能數據路由": {
              "Phase1A路由": "基礎價格、成交量數據",
              "Indicators路由": "完整OHLCV + 深度數據",
              "Phase1B路由": "波動率、成交量突變數據",
              "Phase1C路由": "標準化後的完整數據包",
              "時間": "3ms"
            },
            "⚡ 極端市場檢測": {
              "檢測條件": "BTC價格>3%變動 OR 成交量>8x突增",
              "緊急分發": "跳過常規隊列，直接推送",
              "通知機制": "向所有Phase1模組發送緊急標記",
              "時間": "1ms"
            }
          },
          "輸出": "distributed_phase1_real_time_feeds",
          "視覺流程": "✅ 驗證數據 → 🕐 時間廣播 → 📊 智能路由 → ⚡ 緊急檢測 → 🚀 分發完成"
        }
      }
    },

    "⚡ 性能視覺化": {
      "總處理時間": "12ms (2+5+5ms)",
      "極端市場": "<15ms 緊急分發",
      "分層時間分配": {
        "🌐 連接管理": "2ms (多交易所連接池)",
        "📡 數據處理": "5ms (接收+驗證+標準化)",
        "🚀 信號分發": "5ms (時間同步+路由+緊急檢測)"
      },
      "吞吐量指標": {
        "數據處理": ">1000 messages/sec",
        "並行Symbol": "20+ symbols同時處理",
        "分發延遲P99": "<15ms",
        "連接穩定性": ">99.9% uptime"
      }
    },

    "🎯 核心特色視覺化": {
      "🌐 多交易所架構": {
        "描述": "三大交易所並行連接與智能切換",
        "效果": "99.9%數據可用性保證",
        "視覺": "🏢 Binance(70%) + 🏢 OKX(20%) + 🏢 Bybit(10%) → 🔄 故障切換"
      },
      "🕐 Phase1主時間源": {
        "描述": "為整個Phase1提供統一時間基準",
        "效果": "消除時間戳衝突，確保數據同步",
        "視覺": "🕐 統一時鐘 → 📡 廣播 → 🎯 Phase1A/1B/1C/Indicators"
      },
      "⚡ 低延遲處理": {
        "描述": "12ms端到端處理時間",
        "效果": "滿足高頻交易系統需求",
        "視覺": "📡 接收 → 🔄 處理 → 🚀 分發 = 12ms"
      },
      "🚨 極端市場快速響應": {
        "描述": "市場劇烈波動<15ms緊急分發",
        "效果": "確保關鍵時刻數據及時性",
        "視覺": "📊 檢測 → 🚨 觸發 → ⚡ 緊急通道 → 🚀 直達Phase1"
      }
    },

    "🔗 整合點視覺化": {
      "數據來源": [
        "🏢 Binance WebSocket API",
        "🏢 OKX WebSocket API", 
        "🏢 Bybit WebSocket API",
        "📊 市場深度數據流",
        "💱 實時交易數據流"
      ],
      "分發目標": [
        "🎨 phase1a_basic_signal_generation",
        "📊 indicator_dependency_graph",
        "🌊 phase1b_volatility_adaptation", 
        "⭐ phase1c_signal_standardization",
        "📈 signal_performance_monitor"
      ],
      "系統責任": [
        "🕐 Phase1系統主時間源",
        "📡 實時數據接收處理",
        "🔄 多交易所管理",
        "⚡ 緊急市場響應",
        "📊 數據品質保證"
      ]
    },

    "🛡️ 穩定性視覺化": {
      "🔄 故障恢復": {
        "自動重連": "指數退避策略 (1s, 2s, 4s, 8s)",
        "健康監控": "heartbeat每30s + 數據流監控",
        "故障切換": "<500ms交易所切換時間"
      },
      "📊 數據品質": {
        "異常檢測": "±10%價格突變過濾",
        "時序驗證": "時間戳順序與合理性檢查",
        "完整性檢查": "必要欄位驗證與格式檢查"
      },
      "⚡ 性能監控": {
        "延遲監控": "實時分發延遲統計",
        "吞吐量": "每秒處理消息數追蹤",
        "資源使用": "CPU、記憶體使用率監控"
      }
    }
  }
}
